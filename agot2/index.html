<!DOCTYPE html>
<head>
<!-- JQuery -->
	<script src="https://code.jquery.com/jquery-2.2.2.min.js" integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI=" crossorigin="anonymous"></script>
<!-- BOOTSTRAP -->
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	
<!-- jquery QTIPs -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.1.1/jquery.qtip.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.1.1/jquery.qtip.js"></script>
<!-- TAFFYdb -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/taffydb/2.7.2/taffy-min.js"></script>

<!-- FONT AWESOME -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
	
	<script src="/agot2/js/agot2_filter.js"></script>
	
	<script src="/agot2/js/agot2_data.js"></script>
	<script src="/agot2/js/agot2_deckbuilder.js"></script>
	<script src="/agot2/js/agot2_qtip.js"></script>
	
	<link href="/agot2/css/agot2.css" rel="stylesheet">
	
	<script>
		$(document).ready( function() {
			_cards = TAFFY(CARDS);
			var _titles = JSON.parse(_cards({"Type":"Title"}).stringify());
			var _deck = [];
			var deck = [];
			var plot = [];
			var agenda;
			var faction;
						
			$('#deckload').val("Deck Created with CardGameDB.com A Game of Thrones 2nd Edition Deckbuilder\n\n\nTotal Cards: (50)\n\nFaction: \n Targaryen\n\n\nAgenda: (1)\n1x Fealty (Core Set)\n\nPlot: (7)\n1x Counting Coppers (Core Set)\n1x Confiscation (Core Set)\n1x Fortified Position (Core Set)\n2x The Winds of Winter (Core Set)\n1x Supporting the Faith (Core Set)\n1x A Noble Cause (Core Set)\n\nCharacter: (35)\n3x Braided Warrior (Core Set)\n3x Daenerys Targaryen (Core Set)\n3x Drogon (Core Set)\n3x Handmaiden (Core Set)\n3x Khal Drogo (Core Set)\n2x Magister Illyrio (Core Set)\n3x Rhaegal (Core Set)\n3x Ser Jorah Mormont (Core Set)\n3x Targaryen Loyalist (Core Set)\n3x Unsullied (Core Set)\n3x Viserion (Core Set)\n3x Viserys Targaryen (Core Set)\n\nAttachment: (0)\n\n\nEvent: (9)\n3x Dracarys! (Core Set)\n3x Fire and Blood (Core Set)\n3x Waking the Dragon (Core Set)\n\nLocation: (6)\n3x Illyrio's Estate (Core Set)\n3x Plaza of Punishment (Core Set)");
			
			function drawFactionPlots()	{
				var outp = '';
				$('#faction_name').html ('<h2 class="faction">' + (faction != "The Night's Watch" ? "House " + faction : faction) + (typeof agenda !== "undefined" ? ' <span class="card" data-cardno="' + agenda.Number + '">(' + agenda.name + ')' : '')  + '</span></h2>' );
				
				$.each(plot, function (id, plot) {
					//outp += '<img src="' + plot.img + '" class="card plot_card" data-cardno="' + plot.Number + '" data-cardset="' + plot.Set + '"></img>'
					outp += '<img src="' + plot.img + '" class="card plot_card" data-code="' + plot.code + '"></img>';
				});
				$('#plot_cards').html (outp);
				$('#plot_data').html("Gold: 8");
			}
			function drawTitle() {
				_titles = shuffle(_titles);
				var title = _titles[0];
				//$('#title_card').html('<h4>Title:</h4><img src="' + title.img + '" data-cardno="' + title.Number + '" data-cardset="' + title.Set + '" class="card plot_card"></img>');
				$('#title_card').html('<h4>Title:</h4><img src="' + title.img + '" data-code="' + title.code + '" class="card plot_card"></img>');
			}
			
			function drawCards(n) {
				var card 
				for (var i = 0; i < n; i++) {
					card = deck.pop();
					//$('#hand').append('<img src="' + card.img + '" class="card deck_card" data-cardno="' + card.Number + '" data-cardset="' + card.Set + '"></img>');
					$('#hand').append('<img src="' + card.img + '" class="card deck_card" data-code="' + card.code + '"></img>');
				}
			}
		});
		
		/* Fisher-Yates Shuffle  */
	function shuffle(array) {
		var m = array.length, t, i;

		// While there remain elements to shuffle…
		while (m) {

			// Pick a remaining element…
			i = Math.floor(Math.random() * m--);

			// And swap it with the current element.
			t = array[m];
			array[m] = array[i];
			array[i] = t;
		}

		return array;
	}
	</script>
</head>
<body>
	<div class="container">
		<ul class="nav nav-tabs">
			<li class="active"><a data-toggle="tab" href="#deckbuild">Build</a></li>
			<li><a data-toggle="tab" href="#deckcheck">Check</a></li>
			<li><a data-toggle="tab" href="#decksets">Sets</a></li>
		</ul>
		<div class="tab-content">
			<div id="deckbuild" class="tab-pane active">
				<div class="row">
					<div class="col-md-6">
						<div class="row">
							<input type="text" class="form-control" placeholder="Filter List" id="filterlist">
							<div class="checkbox"><label><input type="checkbox" id="agendaFilter" value="" >Filter based on Faction and Agenda</label></div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="btn-group" data-toggle="buttons" id="cardfilter">
									<label class="btn btn-default btn-sm" title="Faction"><input type="checkbox" name="Faction"><i class="fa fa-flag" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Agenda"><input type="checkbox" name="Agenda"><i class="fa fa-user-plus" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Plot"><input type="checkbox" name="Plot"><i class="fa fa-bookmark" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Character"><input type="checkbox" name="Character"><i class="fa fa-users" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Attachment"><input type="checkbox" name="Attachment"><i class="fa fa-paperclip" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Event"><input type="checkbox" name="Event"><i class="fa fa-bolt" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Location"><input type="checkbox" name="Location"><i class="fa fa-map-marker" aria-hidden="true"></i></label>
								</div>
							</div>
							<div class="col-md-6">
								<div class="btn-group pull-right" data-toggle="buttons" id="factionfilter">
									<label class="btn btn-default btn-sm" title="House Lannister"><input type="checkbox" name="Lannister"><i class="icon icon-lannister"></i></label>
									<label class="btn btn-default btn-sm" title="House Martell"><input type="checkbox" name="Martell"><i class="icon icon-martell" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="The Night's Watch"><input type="checkbox" name="The Night's Watch"><i class="icon icon-watch" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="House Stark"><input type="checkbox" name="Stark"><i class="icon icon-stark" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="House Targaryen"><input type="checkbox" name="Targaryen"><i class="icon icon-targaryen" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="House Tyrell"><input type="checkbox" name="Tyrell"><i class="icon icon-tyrell" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="House Baratheon"><input type="checkbox" name="Baratheon"><i class="icon icon-baratheon" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="House Greyjoy"><input type="checkbox" name="Greyjoy"><i class="icon icon-greyjoy" aria-hidden="true"></i></label>
									<label class="btn btn-default btn-sm" title="Neutral"><input type="checkbox" name="Neutral"><i class="fa fa-plus" aria-hidden="true"></i></label>
								</div>
							</div>
						</div>
						<table id="cardtbl" class="table-condensed">
							<tr>
								<th>Quantity</th>
								<!--th>House</th-->
								<th>Name</th>
								<th>Type</th>
								<th>Cost</th>
								<th>Strength</th>
								<!--th>Set</th-->
							</tr>
							<tbody id="tablebody"></tbody>
						</table>
					</div>
					<div class="col-md-6">
						<div id="decklist"></div>
					</div>
				</div>
			</div>
			<div id="deckcheck" class="tab-pane">
				<div class="row">
					<div class="col-md-6">
						<textarea class="form-control" type="text" id="deckload" rows="5"></textarea>
						<button class="btn btn-default" id="loaddeck">Load</button>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-md-12">
						<div id="faction_name"></div>
						<div id="plot_cards"></div>
					</div>
					<div class="col-md-12">
						<div id="title_card" title="click to refresh" class="title_card"></div>
						<div id="plot_data"></div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12" align="center">
						<b>Draw:&nbsp;</b>
						<div class="btn-group">
							<button type="button" class="btn btn-default btn-sm btn-draw" val="1" id="draw1">1</button>
							<button type="button" class="btn btn-default btn-sm btn-draw" val="2" id="draw2">2</button>
							<button type="button" class="btn btn-default btn-sm btn-draw" val="7" id="draw7">7</button>
							<button type="button" class="btn btn-default btn-sm btn-draw" val="all" id="drawall">All</button>
							<button type="button" class="btn btn-default btn-sm btn-draw" val="0" id="drawreset">Reset</button>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12" align="center">
						<div id="hand"></div>
					</div>
				</div>
				<div id="tmp"></div>
			</div>
			<div id="decksets" class="tab-pane">
				<div class="row">
					<div class="col-md-12">
						<div id="setlist">
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div style="background-color: #DDD; border-top: black solid 2px; padding: 10px 10px 100px;">
		<p><a href="https://icons8.com" target="_blank">Icon pack by Icons8</a>
	</div>
</body>
