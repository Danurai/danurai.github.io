<!DOCTYPE HTML>
<head>
<head>
<!-- JQuery -->
	<script src="https://code.jquery.com/jquery-2.2.2.min.js" integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI=" crossorigin="anonymous"></script>
<!-- JQuery UI
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha256-KM512VNnjElC30ehFwehXjx1YCHPiQkOPmqnrWtpccM=" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" integrity="sha256-rByPlHULObEjJ6XQxW/flG2r+22R5dKiAoef+aXWfik=" crossorigin="anonymous" />
-->
<!-- BOOTSTRAP -->
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
	
<!-- jquery QTIPs -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.1.1/jquery.qtip.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.1.1/jquery.qtip.js"></script>
<!-- TAFFYdb -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/taffydb/2.7.2/taffy-min.js"></script>

<!-- FONT AWESOME -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">

<!-- Site Pages -->
	<style>
	
	.card	{
		width:100px;
		padding: 2px;
	}
	.region	{
		border: 1px solid;
		border-color:	#AAAAAA;
		border-radius: 5px;
		min-height: 150px;
	}
	.region-drop	{
		border-color: #AA0000;
	}
	.row	{
		margin-top: 5px;
	}
	</style>
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-6">
				<div id="hand" class="region"></div>
			</div>
			<div class="col-md-6">
			
			</div>
		</div>
		<div class="row">
			<div class="col-md-6">
				<div id="played" class="region"></div>
			</div>
			<div class="col-md-6">
			</div>
		</div>
	</div>
</body>
<script>
	$(document).ready(function () {
		var _imgs = TAFFY([{"code":"01001","title":"Corp Back","img":"Corp_back.png"},{"code":"01002","title":"Runner Back","img":"Runner_back.png"}]);
	
		var hand = ["01001","01002"];
		var played = [];
		drawHand();
		drawPlayed();
		$(document)
		.on('dragstart','.card', function(ev)	{
			//ev.preventDefault();
			var jsonData = '{"source":"' + $(this).closest('div').attr('id') + '","idx":"'+ $(this).data('idx') + '"}';
			console.log(jsonData);
			ev.originalEvent.dataTransfer.setData('text/plain',jsonData);
		});
		
		$('.region')
		.on('dragover',function(ev)	{
			ev.preventDefault();
			ev.originalEvent.dataTransfer.dropEffect = 'move'; 
			$(this).addClass('region-drop');
		})
		.on('dragleave',function(ev)	{
			$(this).removeClass('region-drop');
		})
		.on('drop',function(ev)	{
			ev.preventDefault();
			$(this).removeClass('region-drop');
			
			var crdData = JSON.parse(ev.originalEvent.dataTransfer.getData('text'));
			src = crdData.source == 'hand' ? hand : played;
			tgt = $(this).attr('id') == 'hand' ? hand : played;
			tgt.push(src.splice(crdData.idx,1)[0]);
			drawHand();
			drawPlayed();
		});
		
		function drawHand()	{
			var outp = '';
			var crd;
			$.each(hand, function(idx,code)	{
				crd = _imgs({"code":code}).first();
				outp += getCardImgEle(crd,idx);
			});
			$('#hand').html(outp);
		}
		function drawPlayed()	{
			var outp = '';
			$.each(played, function(idx,code)	{
				crd = _imgs({"code":code}).first();
				outp += getCardImgEle(crd,idx);
			});
			$('#played').html(outp);
		}
		function getCardImgEle(crd,idx)	{
			var outp = '<img '
				+ 'src="img\\' + crd.img + '"'
				+ 'class="card" draggable="true" '
				+ 'alt="' + crd.title + '" '
				+ 'data-code="'+ crd.code + '" '
				+ 'data-idx="'+ idx + '">'
				+ '</img>';
			return outp;
		}
	});
</script>
</html>